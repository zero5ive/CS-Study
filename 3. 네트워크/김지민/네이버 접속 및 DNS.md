# Q. www.naver.com을 쳤을 때 생기는 과정, 그리고 DNS까지 설명해보기
리다이렉트, 캐싱, DNS, IP 라우팅 & ARP, TCP 연결 구축을 거쳐 요청, 응답이 일어나는 TTFP(Time to First Byte)가 시작되고 이 후 컨텐츠를 다운받게 되고 이 후 브라우저렌더링 과정을 거쳐 네이버라는 화면이 나타나게 됨
![](https://velog.velcdn.com/images/shypanda0119/post/316a8fea-ea30-4667-a0d9-bdedfdce22a6/image.png)

### 리다이렉트
리다이렉트가 있다면 리다이렉트를 진행하고 없다면 그대로 해당 요청에 대한 과정이 진행

### 캐싱
해당 요청이 캐싱이 가능한지 가능하지 않은지를 파악하며, 캐싱이 이미 된 요청이라면 캐싱된 값을 반환하며 캐싱이 되지 않은 새로운 요청이라면 그 다음 단계로 넘어감.

캐싱은 요청된 값의 결과값을 저장하고 그 값을 다시 요청하면 다시 제공하는 기술
이는 브라우저와 공유 캐시로 나눠짐

- 브라우저 캐시
쿠키, 로컬스토리지 등을 포함한 캐시이며, 개인캐시(private cache)라고도 함.
브라우저 자체가 사용자가 HTTP를 통해 다운로드하는 모든 문서를 보유하는 것을 말하며, 예를 들어 어떤 사이트를 갔다가 다시 방문하면 굉장히 빠르게 컨텐츠가 나타나는데 그것이 바로 브라우저 캐시.
인터넷 사용기록을 삭제하고 싶어서 누르려고하면 쿠키 및 기타 사이트 데이터, 캐시라고 있는데 바로 이 부분임.

- 공유 캐시
클라이언트와 서버 사이에 있으며 사용자간에 공유할 수 있는 응답을 저장할 수 있음
대표적인 예로 요청한 서버 앞단에 프록시서버가 캐싱을 하는 것을 말하며, 이를 리버스 프록시를 둬서 내부서버로 포워드한다고 말함
예를 들어 Node.js로 서버를 구축한다면 앞단의 프록시서버로 nginx서버를 둬서 이 서버를 캐싱 서버로도 사용할 수 있는 것
![](https://velog.velcdn.com/images/shypanda0119/post/3315f3d5-8162-4b2c-b0e8-8e1140179539/image.png)
![](https://velog.velcdn.com/images/shypanda0119/post/05c457f4-9c96-4998-9966-cf7803a8aebf/image.png)

만약 캐시가 없다면 계속해서 요청이 생기지만 공유캐시, 브라우저 캐시를 통해 요청을 줄일 수 있음
![](https://velog.velcdn.com/images/shypanda0119/post/46dc3b61-8d35-4d6f-86be-ed40eeba9a39/image.png)

### DNS
이제 캐싱을 거쳐서 요청해야 함이 분명해졌다면 실제서버에 요청할 단계이며, 브라우저가 요청한 FQDN(Fully Qualified Domain Name)인 www.naver.com 등의 이름을 DNS를 통해 실제 IP 주소 확인함.

- FQDN은 호스트와 도메인이 합쳐진 완전한 도메인 이름을 말하며, www 등은 호스트 부분이며 naver.com은 도메인 이라고 함

DNS(Domain Name System)은 계층적인 도메인 구조와 분산된 데이터베이스를 이용한 시스템으로 FQDN을 인터넷 프로토콜인 IP로 바꿔주는 시스템. 이는 DNS 관련 요청을 네임서버로 전달하고 해당 응답값을 클라이언트에게 전달하는 리졸버, 도메인을 IP로 변환하는 네임서버 등으로 이루어져 있음.

예를 들어, www.naver.com에 DNS 쿼리가 오면 오른쪽부터 역순으로 [Root DNS] -> [.com DNS] -> [.naver DNS] -> [.www DNS] 과정을 거쳐 완벽한 주소를 찾아 IP 주소를 매핑
![](https://velog.velcdn.com/images/shypanda0119/post/def0fb6d-54a4-4816-81fa-d4070d9a75cb/image.png)
![업로드중..](blob:https://velog.io/4527bb29-6fe5-433f-bf75-76a825575ffb)

- DNS 캐싱
미리 해당 도메인이름을 요청했다면 로컬 PC에 자동적으로 저장되며, 브라우저 캐싱과 OS캐싱이 있음

### IP 라우팅
해당 IP를 기반으로 IP 라우팅이 일어나고 ARP 과정을 거쳐 실제 서버를 찾음

### TCP 연결 구축
브라우저가 TCP 3웨이 - 핸드셰이크 및 SSL 연결 등을 통해 연결을 설정함. 이후 요청을 보낸 후 드디어 해당 요청한 서버로부터 응답을 받음 TCP연결은 HTTP/2까지 일어나며, HTTP/3는 QUIC을 통해 연결하고 데이터를 주고 받음

### 콘텐츠 다운로드
브라우저는 사용자가 요청한 컨텐츠를 서버로부터 다운

### 브라우저렌더링
받은 데이터를 바탕으로 브라우저 엔진이 브라우저렌더링 과정을 거쳐 화면을 만듬
