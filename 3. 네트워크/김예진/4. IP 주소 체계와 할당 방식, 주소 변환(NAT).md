# 주소의 종류와 주소 변환 (ARP)
- **IP 주소**: 통신을 위한 논리적 식별 번호 (위치에 따라 변함).
- **MAC 주소**: LAN 카드에 부여된 고유한 하드웨어 식별 번호 (변하지 않음).
- **ARP (Address Resolution Protocol)**: IP 주소 -> MAC 주소 변환.
	- 과정: 브로드캐스트(전체 요청) → 유니캐스트(특정 장치 응답).
- **RARP**: MAC 주소 → IP 주소 변환.

# IPv4 vs IPv6
주소 고갈 문제 해결뿐만 아니라 효율성과 속도, 보안 측면에서도 크게 발전했다.

| 구분 | IPv4 | IPv6 |
|------|------|------|
| 주소 길이 | 32비트 (2³²) | 128비트 (2¹²⁸) |
| 표기 방식 | 10진수 4개 (예: 192.168.0.1) | 16진수 8개 (예: 2001:0db8:...) |
| 헤더 길이 | 가변 (20~60바이트) | 고정 (40바이트) → 처리 속도 빠름 |
| 체크섬 | 헤더 체크섬 존재 (매 홉마다 계산) | 삭제됨 (상위 TCP/UDP에 위임) |
| 보안 | 별도 설치 (IPSec 선택) | IPSec 내장 (기본 보안 강화) |
| 생존 주기 | TTL (Time To Live) | Hop Limit |

**IPv6에서 체크섬이 사라진 이유** 
- **효율성**: 라우터가 패킷을 전달할 때마다 헤더 체크섬을 계산하는 부하를 줄이기 위해. 
- **이중 검사 방지**: L4 계층(TCP/UDP)에서 이미 데이터 무결성을 검사하므로 중복을 제거.
- IPv6에서는 UDP 사용 시 체크섬 필드가 필수임 (IPv4에서는 0으로 설정하여 생략 가능했음).

# IP 주소의 구성
* **네트워크 주소 (Network ID)**: 호스트들이 속한 '그룹' 또는 '네트워크'를 식별하는 역할. 동일한 네트워크 주소를 가지면 같은 로컬 네트워크에 속한 것.
* **호스트 주소 (Host ID)**: 해당 네트워크 내에서 개별 장치(컴퓨터, 스마트폰 등)를 식별하기 위한 고유 번호.

## 클래스풀(Classful IP Addressing)

IP 주소의 첫 번째 옥텟(8비트)이 어떻게 시작하느냐에 따라 네트워크의 크기를 구분하여 클래스를 할당하는 주소체계.

| 클래스 | 시작 비트 (2진수) | 첫 번째 옥텟 범위 | 네트워크/호스트 비트 | 가용 호스트 개수 ($-2$) |
| :--- | :--- | :--- | :--- | :--- |
| **A 클래스** | `0...` | `1 ~ 126` | 8 / 24 | $2^{24} - 2 = 16,777,214$ |
| **B 클래스** | `10..` | `128 ~ 191` | 16 / 16 | $2^{16} - 2 = 65,534$ |
| **C 클래스** | `110.` | `192 ~ 223` | 24 / 8 | $2^{8} - 2 = 254$ |

* **D 클래스 (224~239)**: 멀티캐스트용 (1:N 전송용으로 예약)
* **E 클래스 (240~255)**: 연구 및 미래 대비용으로 예약

## 주소 할당 시 주의사항

### 할당 시 -2를 하는 이유
모든 네트워크에서 다음의 두 주소는 장치에 직접 할당할 수 없도록 약속되어 있기 때문이다.

1. **네트워크 주소**: 호스트 ID 부분이 모두 `0`인 주소. 해당 네트워크 자체를 대표하는 주소임.
2. **브로드캐스트 주소**: 호스트 ID 부분이 모두 `1`인 주소. 네트워크 내 모든 장치에게 한꺼번에 데이터를 보낼 때 사용함.

### 제외되는 특수 주소
* **0.0.0.0**: 현재 네트워크 또는 알 수 없는 대상을 의미하는 임시 주소.
* **127.X.X.X (루프백 주소)**: '나 자신'을 가리키는 주소. 주로 `127.0.0.1`을 사용하여 로컬 서버 테스트 시 활용함.

## 클래스풀 방식의 문제점
* **IP 주소의 낭비**: 필요한 IP 개수가 클래스 크기와 맞지 않을 경우, 남는 IP 주소가 버려지게 됨. 
(예: 300개가 필요한데 B클래스를 받으면 6만 개 이상의 주소가 낭비됨)

* **유연성 부족**: 인터넷이 커짐에 따라 고정된 크기의 네트워크만으로는 전 세계의 수많은 장치를 수용하기 어려워짐.

> **해결책**: 이러한 문제를 해결하기 위해 현대에는 클래스 구분 없이 필요한 만큼만 나눠 쓰는 **CIDR(클래스리스)** 방식과 **서브네팅** 기술을 사용함.

# 클래스리스(Classless)
클래스풀(Classful) 방식의 IP 낭비 문제를 해결하기 위해 등장한 현대의 주소 체계. 클래스라는 고정된 틀 대신, **서브넷 마스크**를 통해 네트워크와 호스트 범위를 유연하게 조절한다.

- **서브네팅(Subnetting)**: 하나의 큰 네트워크를 여러 개의 작은 네트워크(서브넷)로 쪼개는 과정.
- **서브넷(Subnet)**: 쪼개진 개별 네트워크.
- **서브넷 마스크(Subnet Mask)**: 어디까지가 네트워크 주소고 어디까지가 호스트 주소인지 구분하기 위한 비트 마스크.


## 클래스풀 vs 클래스리스

|  | 클래스풀 (Classful) | 클래스리스 (Classless / CIDR) |
| :--- | :--- | :--- |
| **마스크 형태** | 고정 서브넷 마스크 (FSM) | 가변 길이 서브넷 마스크 (VLSM) |
| **구분 기준** | 첫 번째 옥텟의 비트 모양 | **CIDR 표기법 (`/n`)** |
| **유연성** | 낮음 (정해진 크기만 가능) | 매우 높음 (필요한 만큼 쪼개기 가능) |


### CIDR (Classless Inter-Domain Routing)
IP 주소와 서브넷 마스크를 슬래시(`/`)로 구분하여 효율적으로 표현하는 표기법.

* **예시**: `192.168.1.0/24`
* **의미**: 32비트 중 앞의 **24비트**가 네트워크 주소라는 뜻.
* **구성**: [IP 주소] / [서브넷 마스크 비트 길이]


## 서브넷 마스크 (Subnet Mask)
네트워크 주소 부분은 `1`, 호스트 주소 부분은 `0`으로 설정함.

* **예시**: `255.255.255.0`
  * 이진수: `11111111.11111111.11111111.00000000`
  * 1의 개수가 24개이므로 CIDR로는 **/24**가 됨.
  
  ![](https://velog.velcdn.com/images/yejiiiin/post/2265bd96-b0e8-4a85-a322-83ea73c30ae5/image.png)


## Q. 서브네팅 계산하기
**Q: 10개의 사무실이 있고, 사무실당 12개의 장치를 연결해야 한다면?**

1. **필요한 IP 개수**: 장치(12개) + 네트워크 주소(1개) + 브로드캐스트 주소(1개) = **최소 14개** 필요.
2. **할당 크기 결정**: 2의 거듭제곱 중 14보다 큰 최소값은 $2^4 = 16$.
3. **서브넷 마스크 결정**:
   - 호스트 비트로 4비트($2^4$)가 필요함.
   - 네트워크 비트는 $32 - 4 = 28$비트.
   - **`/28`** 형식을 사용해야 함.
4. **결과**: 한 서브넷당 16개의 IP를 확보하며, 실제 장치는 $16 - 2 = 14$개까지 연결 가능.


# IP 주소의 부족과 해결책
IPv4 주소($2^{32}$개)의 고갈 문제를 해결하기 위해, 전 세계 모든 장치에 고유한 주소를 부여하는 대신 **내부망(사설)**과 **외부망(공인)**을 구분하여 주소를 아껴 쓰는 방식을 사용한다.

![](https://velog.velcdn.com/images/yejiiiin/post/5b689ddc-1864-402a-8b5f-dd88c59cae31/image.png)


## 공인 IP vs 사설 IP

|   | 공인 IP (Public IP) | 사설 IP (Private IP) |
| :--- | :--- | :--- |
| **정의** | 전 세계에서 유일한 주소 (인터넷 공식 주소) | 특정 네트워크 내부에서만 사용하는 가짜 주소 |
| **할당** | ISP(통신사)가 부여 | 공유기(라우터)가 내부 기기에 부여 |
| **접근성** | 인터넷 어디서든 접속 가능 | 외부 인터넷에서 직접 접속 불가 |
| **비용** | 사용료 발생 (회선 계약) | 무료 (무제한 생성 가능) |

>  사설 IP 대역은 약속되어 있음 (예: `192.168.x.x`, `10.x.x.x` 등)

## NAT (Network Address Translation)
사설 IP를 공인 IP로, 또는 그 반대로 변환해주는 **주소 변환 기술**. 패킷이 라우팅 장치(공유기)를 통과할 때, 출발지 또는 목적지의 IP 주소를 다른 주소로 매핑한다.

* **작동 원리**: 여러 대의 기기(사설 IP)가 외부로 나갈 때, 모두 하나의 공인 IP 주소를 입고 나가는 방식.

### NAT의 장점과 공유기의 역할

**장점**
1. **IP 주소 절약**: 하나의 공인 IP로 수백 대의 기기가 인터넷을 사용하게 함.
2. **보안 강화**: 외부 인터넷에 내부 사설 IP가 노출되지 않으므로, 외부의 직접적인 공격으로부터 내부망을 보호.

- **공유기(Router)와 NAT**
우리가 흔히 쓰는 **Wi-Fi 공유기**의 핵심 기능이 바로 NAT이다.
* 인터넷 회선은 하나(공인 IP 1개)지만, 노트북, 스마트폰, TV가 동시에 인터넷을 할 수 있는 이유.
* 공유기 상세 설정의 'NAT' 설정이나 '포트 포워딩' 등이 이 기술과 밀접하게 연관되어 있다.

---

## 퀴즈


<details> <summary><b>Q: IPv6가 IPv4보다 빠른 근본적인 이유는 무엇인가요?</b></summary> <div markdown="1"> <b>A:</b> 헤더가 40바이트로 <b>고정</b>되어 있고, 라우터에서 <b>체크섬 계산 및 패킷 분할(Fragmentation)</b>을 하지 않기 때문에 CPU 부하가 훨씬 적기 때문임. </div> </details>

<details> <summary><b>Q: ARP 요청은 왜 브로드캐스트로 보내나요?</b></summary> <div markdown="1"> <b>A:</b> 해당 IP를 가진 장비가 네트워크 어디에 있는지 알 수 없으므로, 전체 장비에 물어본 뒤 해당되는 장비만 대답하게 하기 위함임. </div> </details>

<details>
<summary><b>Q: 집에서 사용하는 두 대의 노트북이 각각 네이버에 접속하면, 서버 입장에선 같은 IP일까요?</b></summary>
<div markdown="1">
<b>A:</b> 그렇다. 두 노트북이 다른 사설 IP를 쓰더라도 공유기의 NAT를 거치면 같은 <b>공인 IP</b>로 변환되어 서버에 도착함.
</div>
</details>

<details>
<summary><b>Q: 사설 IP 주소로 직접 외부에서 내 컴퓨터에 접속할 수 없는 이유는?</b></summary>
<div markdown="1">
<b>A:</b> 사설 IP는 전 세계적으로 중복되는 주소이며 인터넷 경로상에 존재하지 않는 주소이기 때문임. 외부 접속을 위해서는 공유기의 '포트 포워딩' 설정이 필요함.
</div>
</details>

<details>
<summary><b>Q: 현대 인터넷 주소 체계에서 클래스리스 방식을 사용하는 가장 큰 이유는?</b></summary>
<div markdown="1">
<b>A:</b> IP 주소 고갈 문제를 늦추기 위해, 조직의 규모에 맞춰 필요한 만큼만 IP를 <b>유연하게 할당하여 낭비를 줄이기 위함</b>임.
</div>
</details>

<details>
<summary><b>Q: 클래스 C 네트워크에서 한 네트워크당 254명의 사용자만 수용할 수 있는 이유는?</b></summary>
<div markdown="1">
<b>A:</b> 호스트 비트가 8비트($2^8=256$)이지만, **네트워크 대표 주소(.0)**와 **브로드캐스트 주소(.255)** 2개를 빼야 하기 때문임.
</div>
</details>

<details>
<summary><b>Q: 루프백 주소(127.0.0.1)는 주로 언제 사용하나요?</b></summary>
<div markdown="1">
<b>A:</b> 외부 네트워크 연결과 상관없이, 내 컴퓨터 내부에서 돌아가는 서버나 서비스가 정상인지 테스트할 때 사용함.
</div>
</details>