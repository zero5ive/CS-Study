# 네이글 알고리즘

네트워크 전송 시 작은 패킷을 매번 보내는 대신, 버퍼에 모아두었다가 한 번에 전송하여 네트워크 효율성을 높이는 알고리즘.

![](https://velog.velcdn.com/images/yejiiiin/post/5e463e59-5dbd-40a4-a4e6-e35d70f85444/image.png)

## 작동 원리
다음 두 조건 중 하나가 만족될 때까지 데이터를 전송하지 않고 버퍼링한다.

1. **MSS(Maximum Segment Size)**: 버퍼에 쌓인 데이터가 최대 세그먼트 크기(보통 1,460 바이트)를 채웠을 때.
2. **ACK 수신**: 이전에 보낸 패킷에 대한 ACK(확인 응답)가 서버로부터 도착했을 때.



## 장점

- **네트워크 혼잡 감소**: 
패킷 수가 많으면 네트워크 장비(라우터, 스위치 등)에 더 많은 네트워크 처리 부담을 주기 때문에 네트워크 혼잡을 증가시킬 수 있다. 자잘한 패킷의 수를 줄여 네트워크의 전반적인 혼잡 상태를 개선하고, 패킷 손실률을 줄일 수 있다.

- **오버헤드 감소**: 
1바이트의 데이터를 보내도 TCP/IP 헤더는 최소 40바이트가 붙는다. 작은 패킷들이 많이 전송되며 늘어나는 헤더 오버헤드를 크게 감소시킬 수 있다.


## 단점
- **지연시간 증가**: 데이터가 충분히 모이거나 ACK가 올 때까지 기다려야 하므로 응답 속도가 중요한 서비스에는 치명적이다.

- **Delayed ACK와의 교착 상태**: 수신측의 Delayed ACK와 송신측의 네이글이 만나면 서로를 기다리며 불필요한 지연이 발생한다.
    
위와 같은 문제로 실시간 데이터 전송이 필요한 애플리케이션(온라인 게임 등)에서는 적합하지 않다


## 활용
- **적합한 곳**: 대용량 파일 전송, 텔넷(Telnet) 등 대역폭 효율이 중요한 서비스.
- **적합하지 않은 곳**: 온라인 게임, 실시간 대화, 금융 거래, 마우스 좌표 전송 등. 소켓 옵션에서 `TCP_NODELAY`를 `true`로 설정하여 알고리즘을 비활성화한다.

