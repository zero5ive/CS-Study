# 네트워크 기초
## 네트워크 정의
노드(node)와 링크(link)가 서로 연결되어 리소스를 공유하는 집합.
- **노드(Node)**: 서버, 라우터, 스위치 등 네트워크 장치
- **링크(Link)**: 유선 또는 무선과 같은 연결 매체 (와이파이나 LAN)


## 네트워크 범위
### LAN (Local Area Network)
- **범위**: 집, 사무실 등 좁은 지역
- **특징**: 높은 전송 속도와 낮은 에러 발생률. 전송 매체(케이블, 공유기)를 사용자가 직접 관리.
- **핵심** (L2 vs L3):
  - **내부 통신**: 동일 LAN 안에서는 IP 주소를 알고 있더라도, 최종적으로는 데이터 링크 계층의 **MAC 주소**를 기반으로 장치를 찾아 통신한다. 
  (이때 IP를 MAC으로 바꾸기 위해 ARP 프로토콜을 사용함)
  - **외부 통신**: 다른 네트워크(WAN)로 나갈 때는 3계층 장비인 라우터를 거치며 **IP 주소**를 기반으로 경로를 찾는다.
- **사설 IP와 NAT**:
  - LAN 내부의 수많은 장치는 **사설 IP(Private IP)**를 할당받아 내부적으로만 유효한 주소를 가진다.
  - 인터넷 접속 시에는 **NAT(Network Address Translation)**를 통해 하나의 **공인 IP(Public IP)**를 공유하여 나간다.
- **장점**: 한정된 공인 IP 자원을 절약하고, 외부에서 내부 사설 IP로 직접 접근하는 것을 차단하여 보안성을 높인다.

### MAN (metropolitan area network)
- **범위**: 도시 단위의 거대 통신망
- **특징**: 여러 개의 LAN을 브리지, 라우터 등으로 연결한 형태. 도시 내 기업이나 공공기관 간의 연결에 주로 쓰인다.

### WAN (wide area network)
- **범위**: 국가, 대륙 간 광범위한 통신망
- **특징**: **인터넷(Internet)**이 대표적인 예시. 수많은 라우터를 거쳐 통신하며, ISP(KT, SKT 등 통신사)가 관리한다. LAN보다 속도가 느리고 에러 발생 가능성이 상대적으로 높다.

## 네트워크 토폴로지 (Topology)
노드와 링크가 어떤 구조로 연결돼있는지를 나타내는 방식.

### 버스(Bus) 토폴로지
**중앙의 긴 회선(백본) 하나에 여러 개의 노드가 연결된 구조. **
모든 노드는 중앙 회선을 통해 데이터를 송수신하며, 네트워크의 모든 통신은 이 하나의 회선을 통해 이루어진다. 

새로운 노드를 추가하더나 삭제하는 것이 쉽고 설치 비용이 적다.

![](https://velog.velcdn.com/images/yejiiiin/post/cba80371-663b-436e-af69-910069d647b7/image.png)


**장점**
- 보통 소규모 네트워크에서 설치되므로 설치 비용이 적고, 간단한 구조라 유지보수가 쉽다.
- 한 노드에 장애가 발생해도 전체 네트워크에 영향을 주지 않는다.

**단점**
- 높은 패킷 손실율. 회선에 많은 트래픽이 생기면 정체 현상이 발생할 가능성이 높다.
- 중앙 회선(백본) 끝의 터미네이터나 회선이 망가지면 전체가 마비된다.
- 모든 노드가 동일 회선을 공유하므로, 패킷 도청(스니핑)이나 위조(스푸핑) 등의 보안 위협에 취약하다.

### 스타(Star) 토폴로지
**중앙 노드를 중심으로 모든 노드가 별 모양처럼 독립적으로 연결된 구조. **

모든 통신은 항상 중앙 노드를 통해서만 이루어진다. 


![](https://velog.velcdn.com/images/yejiiiin/post/623f9a6f-215d-4afb-82df-2d2dd1692c97/image.png)

**장점**
- 한 노드가 고장 나도 다른 노드에 영향이 없다. 
- 보안 장비를 중앙에 집중시킬 수 있다.
- 관리가 쉽다. 중앙 노드를 제외한 노드의 추가 및 삭제가 간단하고 네트워크 전체에 영향을 주지 않는다.

**단점**
- 중앙 노드가 단일 장애점이 되어, 중앙 장비 에러 시 전체 네트워크에 문제 발생

### 트리(Tree) 토폴로지
**계층적(부모-자식) 구조로 노드들이 연결된 형태.**

![](https://velog.velcdn.com/images/yejiiiin/post/88dc695b-2382-410c-9feb-45917bf64966/image.png)


버스 토폴로지와 스타 토폴로지의 형태를 결합해서 하이브리드 구조로 쓰기도 한다.

![](https://velog.velcdn.com/images/yejiiiin/post/1b5aafb7-75b1-4cbb-abe0-d86965fdc4f7/image.png)

**장점**
- 리프노드로의 확장성 높음
- 리프노드의 에러는 나머지 부분에 영향을 주지 않음

**단점**
- 상위 노드에 문제가 생기면 하위 모든 노드에 병목 현상 발생 가능
- 루트 노드에 문제가 생길 경우 전체 네트워크에 영향을 미침


### 링(Ring) 토폴로지
**노드들이 고리(ring) 형태로 연결되어 인접한 두 노드와만 통신**하는 네트워크 구조.

**토큰**을 가진 노드만 데이터를 보내므로 충돌이 없다.

![](https://velog.velcdn.com/images/yejiiiin/post/f4c69c94-ad17-4cfb-b162-f9c2930b6c4f/image.png)

**장점**
- 노드 고장 위치를 비교적 쉽게 파악할 수 있다. 
ex) A → B → C → D → E → A 로 연결된 네트워크에서 C 노드가 고장 나면 → B에서 C로 전송된 데이터가 멈추고 → D는 아무것도 받지 못함
- 각 노드가 앞뒤 두 노드와만 연결되므로 이론적으로 노드 추가/삭제가 간단 
(실제 물리적 네트워크에서는 일시적인 중단이 발생할 수 있음)

**단점**
- 데이터 전송 시 모든 노드를 거쳐야 하므로 전송 지연 발생 가능
- 노드 하나만 고장나도 전체 루프가 끊어짐. 이를 방지하기 위해 실무에서는 이중 링(Dual Ring) 구조를 쓰기도 함.


### 메시(Mesh) 토폴로지
모든 노드들이 **그물망처럼 서로 연결**된 구조. 

![](https://velog.velcdn.com/images/yejiiiin/post/9d450691-b767-4f5b-b0c0-76b5d1251775/image.png)

- **Full Mesh** : 모든 노드가 서로 1:1로 연결되어있는 구조
- **Partial Mesh**: 일부 노드만 연결되어있는 구조

n개의 노드가 있을 때 필요한 회선 수는 ![](https://velog.velcdn.com/images/yejiiiin/post/a33ca858-857a-48ba-b1ee-d2a92f68d928/image.png) 개다.

**장점**
- 신뢰성, 안정성이 높음. 특정 경로에 장애가 나도 우회 경로가 있어 중단 없는 통신 가능.
- 트래픽을 분산할 수 있음.

**단점**
- 연결되는 회선이 많기 때문에 초기 구축 비용, 설계비용, 관리비용이 많아진다. 
- 노드 추가/삭제가 어려움. 노드를 추가하려면 다른 노드들과 새로운 연결을 일일이 구성해야 한다.

## 데이터 전송 방식 (Cast)
||통신 대상|설명|
|--|--|--|
|유니캐스트 (Unicast)|1 : 1|특정 대상 하나와 통신 (예: 일반적인 HTTP 웹 통신)|
|멀티캐스트 (Multicast)|1 : 특정 그룹|특정 그룹에 속한 노드들에게만전송 (예: IPTV, 화상회의)|
|브로드캐스트 (Broadcast)|1 : ALL|네트워크 안의 모든 노드에 전송 (예: ARP, 공유기 초기 연결)|
|애니캐스트 (Anycast)|1 : 가장 가까운 1|동일 주소를 가진 노드 중 가장 물리적으로 가까운 곳과 통신 (예: DNS)|


## 네트워크 성능 지표
### 대역폭 (Bandwidth)
주어진 시간 동안 네트워크 연결을 통해 흐를 수 있는 **최대 데이터 양**. **도로의 차선 수**에 비유된다.

대역폭이 높을 수록 사용자에게 빠른 서비스를 제공할 수 있다. 대략적인 최대 동시 접속자 수 유추의 척도가 된다.

### 트래픽 (Traffic) 
특점 시점에 **링크 내에 흐르는 데이터의 양**. 도로 위에 달리고 있는 **자동차 수**에 비유된다.

예를 들어, 서버에 저장된 파일 등을 클라이언트가 다운로드 시 발생되는 데이터의 누적량을 뜻한다.

- 트래픽이 너무 많아지면 병목 현상이 발생하여 실제 처리량은 오히려 떨어질 수 있음.
 
### 처리량 (Throughput)
**단위 시간 당 성공적으로 전달된 데이터의 양**. 톨게이트를 **무사히 통과한 자동차 수**에 비유된다.

처리량은 사용자들이 많이 접속할 때마다 커지는 트래픽, 네트워크 장치 간의 대역폭, 네트워크 중간에 발생하는 에러, 하드웨어 스펙 등에 영향을 받는다.

- 처리량은 항상 대역폭보다 작거나 같음.
- **TPS (Transactions Per Second)**: 초당 처리하는 트랜잭션(요청/응답)의 수

 
## RTT (Round Trip Time)
**어떤 메시지가 두 장치 사이를 왕복하는 데 걸린 시간**. 신호를 전송하고 해당 신호의 수신 확인에 걸린 시간을 더한 값이다. 

단방향(API 호출 후 응답 받기까지의 대기 시간)은 **Latency**라고 한다.
 
![](https://velog.velcdn.com/images/yejiiiin/post/3a32b519-49e9-48b8-909a-da56d3ac633c/image.png)

**영향을 주는 요소:**
- **전송 지연**: 매체를 타고 이동하는 시간 (물리적 거리)
- **전달 지연**: 라우터 등 장비에서 패킷을 처리하는 시간
- **대기 지연**: 네트워크 혼잡으로 인해 버퍼에서 기다리는 시간


## 병목현상 (Bottleneck)
네트워크에서 **트래픽이 특정 구간에 집중되어 전체 시스템의 속도가 제한**되는 현상. 시스템 전체의 성능은 가장 낮은 성능을 가진 구간에 의해 결정된다.

**원인**
**1. 대역폭 부족**: 하드웨어(라우터, 스위치, 특정 링크)가 감당할 수 있는 트래픽보다 많은 데이터가 몰릴 때. 
2**. 리소스 한계**: 서버 CPU, 메모리, 스레드 풀 부족으로 인한 패킷 처리. 
**3. 설계 상 결함(SPOF)**: 특정 경로에만 트래픽이 몰리도록 설계된 토폴로지 구조일 때. 

**해결 방법**
- **Scale-up (수직 확장)**: 서버의 CPU, RAM 사양을 높여 처리 능력 강화
- **Scale-out (수평 확장): 로드밸런서**를 도입하여 여러 서버로 트래픽 분산 및 회선 추가

  - 로드 밸런서의 종류
    - L4 로드밸런서: IP 주소와 포트 번호를 기준으로 단순 분산 (전송 계층)
    - L7 로드밸런서: HTTP 헤더, URL 등 실제 데이터 내용을 분석하여 분산 (애플리케이션 계층) 
    예: `/user` 요청은 A 서버군, `/order` 요청은 B 서버군으로 전송



---
# 퀴즈

<details>
<summary><b>Q: 서버 부하 분산을 위해 로드밸런서를 도입했을 때 생길 수 있는 병목 현상은?</b></summary>
<div markdown="1">

**A:** 로드밸런서 장비 자체가 감당할 수 있는 트래픽 대역폭을 넘어서거나, 로드밸런서 설정이 잘못되어 특정 서버로만 트래픽이 쏠릴 경우 해당 지점에서 병목이 발생할 수 있다.

</div>
</details>

<details>
<summary><b>Q: 백엔드 서비스의 처리량(Throughput)을 높이기 위해 할 수 있는 것은?</b></summary>
<div markdown="1">

**A:** 
1. **코드 레벨**: 알고리즘 최적화 및 로직 개선 
2. **데이터베이스**: DB 인덱싱을 통한 쿼리 속도 개선 
3. **인프라**: 캐싱 시스템(Redis 등) 도입 
4. **확장**: 로드밸런서를 통한 **Scale-out**(수평 확장)

</div>
</details>