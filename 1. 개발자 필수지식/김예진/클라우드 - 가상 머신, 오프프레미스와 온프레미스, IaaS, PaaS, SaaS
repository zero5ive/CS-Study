# 가상머신

## 인프라 배포 방식의 진화

| 구분 | 전통적 배포 (Bare-metal) | 가상화 배포 (VM) | 컨테이너 배포 (Docker) |
|------|-------------------------|------------------|------------------------|
| 구조 | OS 위에 앱 직접 설치 | Host OS 위에 Guest OS 탑재 | Host OS 커널 공유 + 프로세스 격리 |
| 특징 | 자원 낭비, 환경 충돌 위험 | 완전한 독립성, 하지만 무거움 | **경량, 빠른 속도, 높은 이식성** |
| 격리 수준 | 낮음 | 매우 높음 (HW 수준) | 중간 (OS 프로세스 수준) |

## 가상화 기술과 하이퍼바이저
### 하이퍼바이저 (Hypervisor)

![image](https://github.com/user-attachments/assets/9379a2a1-12b6-41ba-a698-52b74301f4a0)

가상 컴퓨터를 여러 개 구동할 수 있도록, 물리적 자원을 가상화하여 여러 VM에 할당하는 중간계층
- Type 1 (Native): HW 위에 직접 실행. 성능이 좋고 안정적이라 엔터프라이즈 환경에서 주로 사용. (KVM, Hyper-V)
- Type 2 (Hosted): 기존 OS 위에서 실행. 테스트 및 개인 개발용으로 적합. (VirtualBox, VMware)

> 이러한 가상화 기술을 통해, 한 대의 하드웨어로 여러 명의 사용자들에게 독립적으로 클라우드 서비스가 가능해짐

### 가상 머신(VM)의 한계
- 각 VM마다 독립적인 Guest OS가 필요하므로 커널 설치를 위한 용량이 큼 (오버헤드)
- 부팅 시 커널을 처음부터 로드해야 하므로 컨테이너에 비해 느림
  
  
# 오프프레미스(off-premise)와 온프레미스(on-premise)
서비스를 어디에 구축하고 누가 관리하는지에 따른 구분

|| 온프레미스 (On-premise)|오프프레미스 (Off-premise / Cloud)|
|--|--|--|
|정의|기업이 자체적으로 데이터 센터(IDC)를 구축|클라우드 공급자(AWS, NCP 등)의 인프라 이용|
|관리|네트워크 선부터 서버, DB까지 직접 관리|공급자가 호스팅하고 인터넷을 통해 제공|
|비용|CAPEX (자본 지출): 초기 구축 비용 높음|OPEX (운영 지출): 초기 비용 낮고 쓴 만큼 지불|
|장점|물리적 보안 및 데이터 통제권 완벽 확보|유연한 확장(Scalability) 및 비용 효율성|



## IaaS와 PaaS와 SaaS
### IaaS (Infrastructure as a Service)
- 인프라형 클라우드 서비스
- 오직 인프라만 제공하는 클라우드
- OS 선택, 런타임(Node.js 등) 설치, 애플리케이션 개발, 데이터 관리 등 거의 모든 것을 사용자가 관리
- 특정 서비스에 종속되지 않는 높은 자유도를 가짐
- ex) AWS EC2, NCP (Server)

### PaaS (Platform as a Service)
- 플랫폼형 클라우드 서비스
- 개발에 필요한 플랫폼(런타임, DB, 모니터링 툴 등)까지 모두 제공
- 사용자는 오직 애플리케이션 소스 코드와 데이터만 관리
- 인프라 설정 및 CI/CD 구축 비용 절감 가능
- ex) heroku

### SaaS (Software as a Service)
- 서비스형 클라우드 서비스
- 완전한 서비스를 클라우드 서비스로부터 제공받아 사용
- ex) 구글 DOCS

## IaaS와 Paas

| | IaaS (인프라형) | PaaS (플랫폼형)|
|--|--|--|
|유연성|높음(OS부터 내 마음대로 설정)	|낮음(제공되는 환경 내에서만 가능)|
|이식성|높음 (다른 서버로 이전하기 쉬움)	|낮음(플랫폼에 종속되어 이전이 어려움)|
|운영비 효율|낮음(로깅, 모니터링 등을 직접 구축)|높음 (플랫폼이 제공하는 도구 활용)|

# 컨테이너와 도커
## 컨테이너
애플리케이션과 실행에 필요한 모든 환경(코드, 라이브러리 등)을 하나로 패키징한 소프트웨어 단위

![](https://velog.velcdn.com/images/yejiiiin/post/73dc0abf-8461-48b2-b2ac-7467e1f055e3/image.png)

- 핵심 원리 (격리 기술):
  - Namespace: 각 프로세스가 독립된 공간(네트워크, 사용자, 파일시스템 등)을 보게 함
  - Cgroups (Control Groups): 각 컨테이너가 사용할 CPU, 메모리 양을 제한

- 장점
OS 커널을 공유하므로 VM보다 월등히 가볍고 부팅이 빠름.

- 단점
Host OS 커널을 공유하므로, 커널 레벨의 보안 취약점에 노출될 경우 격리벽이 무너질 수 있음 (VM보다 보안 수준 낮음)



## 도커 (Docker)
컨테이너 기반의 오픈소스 가상화 플랫폼으로, 컨테이너 배포에 필요한 거의 모든 기능을 제공
- IaaS의 장점인 유연성, 이식성, PaaS의 장점인 운영비 효율을 모두 장점으로 가짐

### 도커의 과정

<img width="760" height="304" alt="Image" src="https://github.com/user-attachments/assets/9379a2a1-12b6-41ba-a698-52b74301f4a0" />

1. 도커 파일
   - 패키지 설치, 환경 변수, 실행 명령 등을 기록한 텍스트 기반 스크립트
   - 이를 빌드해 도커 이미지로 변경

2. 도커 이미지
   - 한 번 빌드된 이미지는 수정되지 않으며, 실행 중 상태가 변해도 이미지는 원본을 유지함
   - 하나의 이미지에서 여러 개의 컨테이너를 생성할 수 있음
   - 여러 개의 읽기 전용(Read-only) 레이어가 쌓인 형태로, 바뀐 부분(Layer)만 새로 만들기 때문에 용량과 시간이 크게 절약됨

3. 도커 컨테이너
   - 이미지를 실행한 상태
   - 이미지 레이어 위에 쓰기 가능한(Writable) 레이어를 한 층 올려서 데이터를 저장하고 수정
   - 컨테이너가 실행시키면 도커 이미지에 설정된 프로그램, 데이터 등이 실제 컴퓨팅 자원과 연결됨
   
   
